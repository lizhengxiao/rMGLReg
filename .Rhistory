table1
row.names(table1) <- c('MGL180', 'MGLEV180', 'Gumbel')
colnames(table1) <- c("estimates", "estimates","estimates", "estimates", "se", "se", "se","se",'loglike', 'AIC', 'BIC')
knitr::kable(t(table1), digits = 3)
m.MGL180 <- MGL.reg.mixed(obs = y, U = U, U_ = U_, umin = umin, f = f, X = X,
copula = "MGL180",
method = "Nelder-Mead",
initpar = c(-0.32, 1, 1))
X
dim(X)
estimates.copula <- rbind((m.MGL180$estimates), (m.MGLEV180$estimates), (m.gumbel$estimates))
sd.copula <- rbind((m.MGL180$se), (m.MGLEV180$se), (m.gumbel$se))
ll.copula <- rbind((m.MGL180)$loglike, (m.MGLEV180)$loglike, (m.gumbel)$loglike)
AIC.copula <- rbind((m.MGL180)$AIC, (m.MGLEV180)$AIC, (m.gumbel)$AIC)
BIC.copula <- rbind((m.MGL180)$BIC, (m.MGLEV180)$BIC, (m.gumbel)$BIC)
table1 <- cbind(estimates.copula, sd.copula, ll.copula, AIC.copula, BIC.copula)
row.names(table1) <- c('MGL180', 'MGLEV180', 'Gumbel')
colnames(table1) <- c("estimates", "estimates","estimates", "estimates", "se", "se", "se","se",'loglike', 'AIC', 'BIC')
knitr::kable(t(table1), digits = 3)
# Survival MGL regression model
par.est <- m.MGL180$estimates
agepred <- seq(from = 1980, to = 1990)
Xcopula <-  splines::ns(agepred, knots = quantile(dtnew$year, c(0.5)), intercept = T)
# Survival MGL regression model
par.est <- m.MGL180$estimates
agepred <- seq(from = 1990, to = 2015, by = 1)
Xcopula <-  ns(agepred, knots = quantile(dtnew$year, c(0.333, 0.667)), intercept = T)
par.est
agepred <- seq(from = 1990, to = 2015, by = 1)
Xcopula <-  ns(agepred, knots = quantile(dtnew$year, c(0.333, 0.667)), intercept = T)
Xcopula <-  ns(agepred, knots = quantile(earthqCHI$year, c(0.333, 0.667)), intercept = T)
delta.est <- exp(Xcopula%*%par.est)
# Survival MGL regression model
par.est <- m.MGL180$estimates
agepred <- seq(from = 1990, to = 2015, by = 1)
Xcopula <-  ns(agepred, knots = quantile(earthqCHI$year, c(0.333, 0.667)), intercept = T)
delta.est <- exp(Xcopula%*%par.est)
cov.est <- -solve(m.MGL180$hessian)
beta.sim <- matrix(0, nrow = 100, ncol = 4)
delta.mat <- matrix(0, nrow = length(agepred), ncol = 100)
beta.sim <- mvrnorm(100, mu = par.est, Sigma = cov.est)
??mvrnorm
mvrnorm
library(MASS)
# Survival MGL regression model
par.est <- m.MGL180$estimates
agepred <- seq(from = 1990, to = 2015, by = 1)
Xcopula <-  ns(agepred, knots = quantile(earthqCHI$year, c(0.333, 0.667)), intercept = T)
delta.est <- exp(Xcopula%*%par.est)
cov.est <- -solve(m.MGL180$hessian)
beta.sim <- matrix(0, nrow = 100, ncol = 4)
delta.mat <- matrix(0, nrow = length(agepred), ncol = 100)
beta.sim <- mvrnorm(100, mu = par.est, Sigma = cov.est)
for(i in 1:100){
delta.mat[,i] <- exp(Xcopula%*%beta.sim[i,])
}
matplot(delta.mat, col = 'gray', type = 'l', ylim = c(0, 2), main = 'Survival MGL')
lines(delta.est, col = 'red', lwd = 2)
library(MASS)
# Survival MGL regression model
par.est <- m.MGL180$estimates
agepred <- seq(from = 1990, to = 2015, by = 1)
Xcopula <-  ns(agepred, knots = quantile(earthqCHI$year, c(0.333, 0.667)), intercept = T)
delta.est <- exp(Xcopula%*%par.est)
cov.est <- -solve(m.MGL180$hessian)
beta.sim <- matrix(0, nrow = 100, ncol = 4)
delta.mat <- matrix(0, nrow = length(agepred), ncol = 100)
beta.sim <- mvrnorm(100, mu = par.est, Sigma = cov.est)
for(i in 1:100){
delta.mat[,i] <- exp(Xcopula%*%beta.sim[i,])
}
matplot(delta.mat, col = 'gray', type = 'l', ylim = c(0, 2), main = 'Survival MGL')
lines(delta.est, col = 'red', lwd = 2)
# Surivial MGL-EV regression
par.est <- m.MGLEV180$estimates
agepred <- seq(from = 1980, to = 1990)
Xcopula <-  ns(agepred, knots = quantile(dtnew$year, c(0.5)), intercept = T)
library(MASS)
# Survival MGL regression model
par.est <- m.MGL180$estimates
agepred <- seq(from = 1990, to = 2015, by = 1)
Xcopula <-  ns(agepred, knots = quantile(earthqCHI$year, c(0.333, 0.667)), intercept = T)
delta.est <- exp(Xcopula%*%par.est)
cov.est <- -solve(m.MGL180$hessian)
beta.sim <- matrix(0, nrow = 100, ncol = 4)
delta.mat <- matrix(0, nrow = length(agepred), ncol = 100)
beta.sim <- mvrnorm(100, mu = par.est, Sigma = cov.est)
for(i in 1:100){
delta.mat[,i] <- exp(Xcopula%*%beta.sim[i,])
}
matplot(delta.mat, col = 'gray', type = 'l', ylim = c(0, 2), main = 'Survival MGL')
lines(delta.est, col = 'red', lwd = 2)
# Surivial MGL-EV regression
par.est <- m.MGLEV180$estimates
delta.est <- exp(Xcopula%*%par.est)
cov.est <- -solve(m.MGLEV180$hessian)
beta.sim <- matrix(0, nrow = 100, ncol = 4)
delta.mat <- matrix(0, nrow = length(agepred), ncol = 100)
beta.sim <- mvrnorm(100, mu = par.est, Sigma = cov.est)
for(i in 1:100){
delta.mat[,i] <- exp(Xcopula%*%beta.sim[i,])
}
matplot(delta.mat, col = 'gray', type = 'l', ylim = c(0, 2), main = 'Survival MGL-EV')
lines(delta.est, col = 'red', lwd = 2)
# Gumbel regression
par.est <- m.gumbel$estimates
delta.est <- exp(Xcopula%*%par.est) + 1
cov.est <- -solve(m.gumbel$hessian)
beta.sim <- matrix(0, nrow = 100, ncol = 4)
delta.mat <- matrix(0, nrow = length(agepred), ncol = 100)
beta.sim <- mvrnorm(100, mu = par.est, Sigma = cov.est)
for(i in 1:100){
delta.mat[,i] <- exp(Xcopula%*%beta.sim[i,]) + 1
}
matplot(delta.mat, col = 'gray', type = 'l', ylim = c(0, 2), main = 'Gumbel')
lines(delta.est, col = 'red', lwd = 2)
library(MASS)
# Survival MGL regression model
par.est <- m.MGL180$estimates
agepred <- seq(from = 1990, to = 2015, by = 1)
Xcopula <-  ns(agepred, knots = quantile(earthqCHI$year, c(0.333, 0.667)), intercept = T)
delta.est <- exp(Xcopula%*%par.est)
cov.est <- -solve(m.MGL180$hessian)
beta.sim <- matrix(0, nrow = 100, ncol = 4)
delta.mat <- matrix(0, nrow = length(agepred), ncol = 100)
beta.sim <- mvrnorm(100, mu = par.est, Sigma = cov.est)
for(i in 1:100){
delta.mat[,i] <- exp(Xcopula%*%beta.sim[i,])
}
matplot(delta.mat, col = 'gray', type = 'l', ylim = c(0, 6), main = 'Survival MGL')
lines(delta.est, col = 'red', lwd = 2)
# Surivial MGL-EV regression
par.est <- m.MGLEV180$estimates
delta.est <- exp(Xcopula%*%par.est)
cov.est <- -solve(m.MGLEV180$hessian)
beta.sim <- matrix(0, nrow = 100, ncol = 4)
delta.mat <- matrix(0, nrow = length(agepred), ncol = 100)
beta.sim <- mvrnorm(100, mu = par.est, Sigma = cov.est)
for(i in 1:100){
delta.mat[,i] <- exp(Xcopula%*%beta.sim[i,])
}
matplot(delta.mat, col = 'gray', type = 'l', ylim = c(0, 6), main = 'Survival MGL-EV')
lines(delta.est, col = 'red', lwd = 2)
# Gumbel regression
par.est <- m.gumbel$estimates
delta.est <- exp(Xcopula%*%par.est) + 1
cov.est <- -solve(m.gumbel$hessian)
beta.sim <- matrix(0, nrow = 100, ncol = 4)
delta.mat <- matrix(0, nrow = length(agepred), ncol = 100)
beta.sim <- mvrnorm(100, mu = par.est, Sigma = cov.est)
for(i in 1:100){
delta.mat[,i] <- exp(Xcopula%*%beta.sim[i,]) + 1
}
matplot(delta.mat, col = 'gray', type = 'l', ylim = c(0, 6), main = 'Gumbel')
lines(delta.est, col = 'red', lwd = 2)
?earthqCHI
library(rMGLReg)
library(fitdistrplus)
library(splines)
library(snpar)
data("danishmulti")
dt <- data.table::data.table(danishmulti)
dtnew <- dt[Building>0&Contents>0]
y1 <- dtnew$Building
y2 <- dtnew$Contents
y <- cbind(y1, y2)
# empirical cdf
u1 <- snpar::kde(y[,1], kernel = "gaus",
xgrid = y[,1],
h = 0.2)$Fhat
u2 <- snpar::kde(y[,2], kernel = "gaus",
xgrid = y[,2],
h = 0.2)$Fhat
U <- cbind(u1, u2) # bivariate pseudo copula data.
plot(U)
library(ggplot2)
library(latex2exp)
Usample <- U
XY <- y
newtheme <-   theme_bw() + theme(axis.line = element_line(colour = "black"),
axis.text.x = element_text(margin = margin(t = 0.25, unit = "cm")),
axis.text.y = element_text(margin = margin(r = 0.25, unit = "cm"),
size = 10,
vjust = 0.5,
hjust = 0.5),
axis.ticks.length = unit(-0.1, "cm"),
plot.title = element_text(hjust = 0.5),
legend.direction = 'vertical',
legend.position = c(.95, .99),
legend.justification = c("right", "top"),
legend.box.just = "right",
legend.text = element_text(size = 10))
dtplot <- data.frame(U1 = Usample[,1], U2 = Usample[,2],
logY1 = log(XY[,1]), logY2 = log(XY[,2]))
p1 <- ggplot(data = dtplot, mapping = aes(y = logY1,
x = logY2)) +
newtheme +
geom_point() +
labs(title = "",
x = TeX("$log Y_1$"),
y = TeX("$log Y_2$")) +
scale_x_continuous(limits = c(-7.5, 5),
breaks = seq(-7.5, 5, by = 2.5)) +
scale_y_continuous(limits = c(-5, 5),
breaks = seq(-5, 5, by = 2.5))
p1
p2 <- ggplot(data = dtplot, mapping = aes(y = U2,
x = U1)) +
newtheme +
geom_point() +
labs(title = "",
x = TeX("$u_1$"),
y = TeX("$u_2$")) +
scale_x_continuous(limits = c(0, 1),
breaks = seq(0, 1, by = 0.2)) +
scale_y_continuous(limits = c(0, 1),
breaks = seq(0, 1, by = 0.2))
p2
library(patchwork)
p0 <- p1 + p2 + plot_layout(ncol = 2)
p0
p0
library(rMGLReg)
library(devtools)
check(cleanup = FALSE,manual = TRUE,path = getwd())
build_manual(path=getwd())
build_manual(path=getwd())
？build_manual
?build_manual
getwd()
build_manual(pkg = "rMGLReg", path=getwd())
??rMGLReg
library(rMGLReg)
rMGLReg
??rMGLReg
?Rd2pdf
Rd2pdf()
install.packages("pkgdown")
usethis::use_pkgdown()
use_pkgdown_github_pages()
use_pkgdown_github_pages()
pkgdown::build_site()
?rMGLReg
usethis::use_pkgdown()
usethis::use_pkgdown()
pkgdown::build_site()
pkgdown::build_site()
pkgdown::build_site()
?rMGLReg
??rMGLReg
usethis::use_code_of_conduct()
usethis::use_github_links()
usethis::use_github_links()
usethis::use_github_links()
usethis::use_github_links()
usethis::use_github_links()
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>",
fig.path = "man/figures/README-",
out.width = "100%"
)
library(rMGLReg)
## basic example code
set.seed(271)
n <- 1000
delta <- 1.2
d <- 3
U <- rcMGL.multi(n = 1000, d = d, pars = delta)
cor(U, method = "kendall")
par(pty = "s")
pairs(U, gap = 0, cex = 0.5)
# simulated data
set.seed(111)
Nsim <- 1000
beta.true <- c(-0.6, 0.5, 0.2) # true regression coefficients
x1 <- rnorm(n, 0, 1)
x2 <- rnorm(n, 0, 1)
X <- model.matrix(~ x1 + x2) # design matrix
delta.sim <- as.vector(exp(X%*%beta.true)) # true copula parameters
Usim <- matrix(0, nrow = n, ncol = d)
for (i in 1:n){
Usim[i, ] <- rcMGL.multi(n = 1, d = d, pars = delta.sim[i])
}
m.MGLMGA <- fit.cop.IFM.reg(U = Usim,
dcop = dGM.reg,
method = "Nelder-Mead",
X = X,
control = list(maxit = 100000,
fnscale = -1),
initpar = beta.true)
m.MGLMGA <- MGL.reg(U = U, copula = "MGL",
X = X, method = "Nelder-Mead",
initpar = c(-0.32, 0.001, 0.001)
)
m.MGLMGA$estimates
# simulated data
set.seed(111)
Nsim <- 1000
n <- 1000 # sample size
beta.true <- c(-0.6, 0.5, 0.2) # true regression coefficients
x1 <- rnorm(n, 0, 1)
x2 <- rnorm(n, 0, 1)
X <- model.matrix(~ x1 + x2) # design matrix
delta.sim <- as.vector(exp(X%*%beta.true)) # true copula parameters
Usim <- matrix(0, nrow = n, ncol = d)
for (i in 1:n){
Usim[i, ] <- rcMGL.multi(n = 1, d = d, pars = delta.sim[i])
}
m.MGLMGA <- MGL.reg(U = U, copula = "MGL",
X = X, method = "Nelder-Mead",
initpar = c(-0.32, 0.001, 0.001)
)
m.MGLMGA$estimates
m.MGLMGA <- MGL.reg(U = Usim, copula = "MGL",
X = X, method = "Nelder-Mead",
initpar = c(-0.32, 0.001, 0.001)
)
m.MGLMGA <- MGL.reg(U = Usim, copula = "MGL",
X = X, method = "Nelder-Mead",
initpar = c(-0.32, 0.001, 0.001)
)
m.MGLMGA$estimates
m.MGLMGA
library(rMGLReg)
pkgdown::build_site()
usethis::use_pkgdown()
pkgdown::build_site()
？strrep
sethis::use_pkgdown()
usethis::use_pkgdown()
usethis::use_pkgdown()
usethis::use_pkgdown()
pkgdown::build_site()
pkgdown::build_site()
pkgdown::build_site()
vignette()
vignette('rMGLReg')
browseVignettes(package  = "rMGLReg")
library(rMGLReg)
browseVignettes(package  = "rMGLReg")
library(rMGLReg)
browseVignettes(package  = "rMGLReg")
vignette()
help(package="rMGLReg")
?rMGLReg
??rMGLReg
demo()
browseVignettes(package="survival")
browseVignettes(package="rMGLReg")
usethis::use_vignette("counter-plot-MGL-copula")
usethis::use_vignette("counter-plot-MGLMGA")
usethis::use_vignette("MGL-fitting")
usethis::use_vignette("MGL-fitting-mixed")
usethis::use_vignette("MGL-regression")
usethis::use_vignette("MGL-regression-mixed")
library(rMGLReg)
browseVignettes(package="rMGLReg")
library(rMGLReg)
browseVignettes(package="rMGLReg")
devtools::build_vignettes()
browseVignettes(package="rMGLReg")
library(rMGLReg)
browseVignettes(package="rMGLReg")
remotes::install_local(, build_vignettes = TRUE)
remotes::install_local(build_vignettes = TRUE)
?install_local
devtools::install_github(build_vignettes = TRUE)
remotes::install_local(build_vignettes = TRUE)
remotes::install_local(build_vignettes = TRUE, force = TRUE)
devtools::install_github("lizhengxiao/rMGLReg")
library(rMGLReg)
help(package = rMGLReg)
browseVignettes(package  = "rMGLReg")
rmarkdown::html_vignette
rmarkdown::html_vignette()
usethis::use_pkgdown()
pkgdown::build_site()
usethis::use_tidy_github_actions()
library(rMGLReg)
devtools::build_rmd()
session_info()
session_info()
library(rMGLReg)
session_info()
devtolls::install_github("lizhengxiao/rMGLReg", build_vignettes = TRUE, force = TRUE)
devtools::install_github("lizhengxiao/rMGLReg", build_vignettes = TRUE, force = TRUE)
devtools::install_github("lizhengxiao/rMGLReg", build_vignettes = TRUE, force = TRUE)
browseVignettes(package="rMGLReg")
renv::status()
？gss
?gss
library(gss)
??gss
renv::snapshot()
pkgdown::build_site()
?pkgdown
warnings()
usethis::use_tidy_github_actions()
library(rMGLReg)
browseVignettes(package  = "rMGLReg")
usethis::use_pkgdown()
pkgdown::build_site()
library(rMGLReg)
library(rMGLReg)
library(rMGLReg)
help(package = rMGLReg)
browseVignettes(package  = "rMGLReg")
help(package = rMGLReg)
browseVignettes(package  = "rMGLReg")
#' delta <- 0.7
#' w.vector <- seq(0.0001, 0.9999, length.out = 100)
#' y.vector <- Afunction(w = w.vector, param = delta)
delta <- 0.1
w.vector <- seq(0.0001, 0.9999, length.out = 100)
y.vector <- Afunction(w = w.vector, param = delta)
lines(w.vector, y.vector, lwd = 2, col = 2)
delta <- 0.7
w.vector <- seq(0.0001, 0.9999, length.out = 100)
y.vector <- Afunction(w = w.vector, param = delta)
lines(w.vector, y.vector, lwd = 2, col = 3)
delta <- 1
w.vector <- seq(0.0001, 0.9999, length.out = 100)
y.vector <- Afunction(w = w.vector, param = delta)
lines(w.vector, y.vector, lwd = 2, col = 4)
delta <- 3
w.vector <- seq(0.0001, 0.9999, length.out = 100)
y.vector <- Afunction(w = w.vector, param = delta)
lines(w.vector, y.vector, lwd = 2, col = 5)
param <- 5
w.vector <- seq(0.0001, 0.9999, length.out = 100)
y.vector <- Afunction(w = w.vector, param = param)
par(mfrow = c(1, 1))
lines(w.vector, y.vector, lwd = 2, col = 1)
# delta <- 0.01
# w.vector <- seq(0.0001, 0.9999, length.out = 100)
# y.vector <- Afunction(w = w.vector, param = delta)
# par(mfrow = c(1, 1))
# plot(w.vector, y.vector, type = 'l', lwd = 2, ylim = c(0.5, 1))
#
#
delta <- 0.01
w.vector <- seq(0.0001, 0.9999, length.out = 100)
y.vector <- Afunction(w = w.vector, param = delta)
par(mfrow = c(1, 1))
plot(w.vector, y.vector, type = 'l', lwd = 2, ylim = c(0.5, 1))
Afunction
library(rMGLReg)
y.vector <- Afunction(w = w.vector, param = delta)
# delta <- 0.01
# w.vector <- seq(0.0001, 0.9999, length.out = 100)
# y.vector <- Afunction(w = w.vector, param = delta)
# par(mfrow = c(1, 1))
# plot(w.vector, y.vector, type = 'l', lwd = 2, ylim = c(0.5, 1))
#
#
delta <- 0.01
w.vector <- seq(0.0001, 0.9999, length.out = 100)
y.vector <- Afunction(w = w.vector, param = delta)
par(mfrow = c(1, 1))
plot(w.vector, y.vector, type = 'l', lwd = 2, ylim = c(0.5, 1))
delta <- 0.1
w.vector <- seq(0.0001, 0.9999, length.out = 100)
y.vector <- Afunction(w = w.vector, param = delta)
lines(w.vector, y.vector, lwd = 2, col = 2)
delta <- 0.7
w.vector <- seq(0.0001, 0.9999, length.out = 100)
y.vector <- Afunction(w = w.vector, param = delta)
lines(w.vector, y.vector, lwd = 2, col = 3)
delta <- 1
w.vector <- seq(0.0001, 0.9999, length.out = 100)
y.vector <- Afunction(w = w.vector, param = delta)
lines(w.vector, y.vector, lwd = 2, col = 4)
delta <- 3
w.vector <- seq(0.0001, 0.9999, length.out = 100)
y.vector <- Afunction(w = w.vector, param = delta)
lines(w.vector, y.vector, lwd = 2, col = 5)
param <- 5
w.vector <- seq(0.0001, 0.9999, length.out = 100)
y.vector <- Afunction(w = w.vector, param = param)
par(mfrow = c(1, 1))
lines(w.vector, y.vector, lwd = 2, col = 1)
?Afunction
library(rMGLReg)
?Afunction
?dgamma
?BMGL
library(rMGLReg)
?BMGL
library(rMGLReg)
pkgdown::build_site()
pkgdown::build_site()
usethis::use_tidy_github_actions()
usethis::use_tidy_github_actions()
usethis::use_tidy_github_actions()
?gamma
usethis::use_tidy_github_actions()
usethis::use_github_action("check-release")
usethis::use_github_action("check-standard")
usethis::use_github_action("check-full")
usethis::use_github_action("test-coverage")
usethis::use_github_action("lint")
usethis::use_github_action("pr-commands")
usethis::use_github_action("render-rmarkdown")
usethis::use_github_action("pkgdown")
usethis::use_github_action("bookdown")
usethis::use_github_action("blogdown")
usethis::use_github_action("docker")
usethis::use_github_action("lint-project")
library(rMGLReg)
usethis::use_news_md()
pkgdown::build_site()
